<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FreeCAD: Command Framework</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FreeCAD
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Command Framework</div>  </div>
</div><!--header-->
<div class="contents">

<p>Structure for registering commands to the FreeCAD system.  
<a href="#details">More...</a></p>
<p>Structure for registering commands to the FreeCAD system. </p>
<h1><a class="anchor" id="Overview"></a>
Overview</h1>
<p>In GUI applications many commands can be invoked via a menu item, a toolbar button or an accelerator key. The answer of Qt to master this challenge is the class <em>QAction</em>. A QAction object can be added to a popup menu or a toolbar and keep the state of the menu item and the toolbar button synchronized.</p>
<p>For example, if the user clicks the menu item of a toggle action then the toolbar button gets also pressed and vice versa. For more details refer to your Qt documentation.</p>
<h1><a class="anchor" id="Drawbacks"></a>
Drawbacks</h1>
<p>Since QAction inherits QObject and emits the <em>triggered()</em> signal or <em>toggled()</em> signal for toggle actions it is very convenient to connect these signals e.g. with slots of your MainWindow class. But this means that for every action an appropriate slot of MainWindow is necessary and leads to an inflated MainWindow class. Furthermore, it's simply impossible to provide plugins that may also need special slots &ndash; without changing the MainWindow class.</p>
<h1><a class="anchor" id="wayout"></a>
Way out</h1>
<p>To solve these problems we have introduced the command framework to decouple QAction and MainWindow. The base classes of the framework are <em><a class="el" href="../../d9/daa/classGui_1_1CommandBase.html">Gui::CommandBase</a></em> and <em><a class="el" href="../../de/d94/classGui_1_1Action.html">Gui::Action</a></em> that represent the link between Qt's QAction world and the FreeCAD's command world.</p>
<p>The Action class holds a pointer to QAction and CommandBase and acts as a mediator and &ndash; to save memory &ndash; that gets created (<a class="el" href="../../d9/daa/classGui_1_1CommandBase.html#a020abce42db2ceb27090e4b3a58a6550">Gui::CommandBase::createAction()</a>) not before it is added (<a class="el" href="../../d2/dff/classGui_1_1Command.html#ae07ba9ae956a04300bb93591d26794b6">Gui::Command::addTo()</a>) to a menu or toolbar.</p>
<p>Now, the implementation of the slots of MainWindow can be done in the method <em>activated()</em> of subclasses of Command instead.</p>
<p>For example, the implementation of the "Open file" command can be done as follows. </p><div class="fragment"><div class="line"><span class="keyword">class </span>OpenCommand : <span class="keyword">public</span> <a class="code" href="../../df/d9c/namespacePath_1_1Op_1_1Gui_1_1Adaptive.html#a0628a7d437d120fc3b671c5dcdc2c940">Command</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  OpenCommand() : <a class="code" href="../../df/d9c/namespacePath_1_1Op_1_1Gui_1_1Adaptive.html#a0628a7d437d120fc3b671c5dcdc2c940">Command</a>(<span class="stringliteral">&quot;Std_Open&quot;</span>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// set up menu text, status tip, ...</span></div>
<div class="line">    sMenuText     = <span class="stringliteral">&quot;&amp;Open&quot;</span>;</div>
<div class="line">    sToolTipText  = <span class="stringliteral">&quot;Open a file&quot;</span>;</div>
<div class="line">    sWhatsThis    = <span class="stringliteral">&quot;Open a file&quot;</span>;</div>
<div class="line">    sStatusTip    = <span class="stringliteral">&quot;Open a file&quot;</span>;</div>
<div class="line">    sPixmap       = <span class="stringliteral">&quot;Open&quot;</span>; <span class="comment">// name of a registered pixmap</span></div>
<div class="line">    sAccel        = <span class="stringliteral">&quot;Shift+P&quot;</span>; <span class="comment">// or &quot;P&quot; or &quot;P, L&quot; or &quot;Ctrl+X, Ctrl+C&quot; for a sequence</span></div>
<div class="line">  }</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <span class="keywordtype">void</span> activated(<span class="keywordtype">int</span>)</div>
<div class="line">  {</div>
<div class="line">    QString filter ... <span class="comment">// make a filter of all supported file formats</span></div>
<div class="line">    QStringList FileList = QFileDialog::getOpenFileNames( filter,QString(), <a class="code" href="../../d9/dad/namespaceGui.html#ac494ec9319490d5390e38cdd70697e93">getMainWindow</a>() );</div>
<div class="line">    <span class="keywordflow">for</span> ( QStringList::Iterator it = FileList.begin(); it != FileList.end(); ++it ) {</div>
<div class="line">      getGuiApplication()-&gt;open((*it).latin1());</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p> An instance of <em>OpenCommand</em> must be created and added to the <a class="el" href="../../d1/da7/classGui_1_1CommandManager.html">Gui::CommandManager</a> to make the class known to FreeCAD. To see how menus and toolbars can be built go to the <a class="el" href="../../d7/dc3/group__workbench.html">Workbench Framework</a>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../d2/dff/classGui_1_1Command.html">Gui::Command</a>, <a class="el" href="../../d1/da7/classGui_1_1CommandManager.html">Gui::CommandManager</a> </dd></dl>
</div><!-- contents -->
<div class="ttc" id="anamespaceGui_html_ac494ec9319490d5390e38cdd70697e93"><div class="ttname"><a href="../../d9/dad/namespaceGui.html#ac494ec9319490d5390e38cdd70697e93">Gui::getMainWindow</a></div><div class="ttdeci">MainWindow * getMainWindow()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d9c/MainWindow_8h_source.html#l00367">MainWindow.h:367</a></div></div>
<div class="ttc" id="anamespacePath_1_1Op_1_1Gui_1_1Adaptive_html_a0628a7d437d120fc3b671c5dcdc2c940"><div class="ttname"><a href="../../df/d9c/namespacePath_1_1Op_1_1Gui_1_1Adaptive.html#a0628a7d437d120fc3b671c5dcdc2c940">Path.Op.Gui.Adaptive.Command</a></div><div class="ttdeci">Command</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd9/Gui_2Adaptive_8py_source.html#l00154">Gui/Adaptive.py:154</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
